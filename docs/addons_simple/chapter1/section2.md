---
sidebar_position: 2
---

# 1.2 JSON 语法基础

**在附加包的编写中，我们要时时刻刻跟 JSON 这个东西打交道**。其实这东西已经不是你第一次见了，在模块 1 的物品组件和文本组件中，我们就曾见过 JSON，只是当时我们只给出了一个固定的格式，却从来没有说过为什么要这么写。可以说，学会 JSON 语法是附加包的一个基础门槛，学不会 JSON 语法就无从谈起写附加包。不过好在，JSON 的语法其实是十分简单的——至少它可比`/execute`简单得多。为了满足我们附加包的编写需求，必须要在系统学习附加包之前先学习 JSON 语法。

## JSON

关于 JSON 的基本表述，可以在这篇[官方网站](https://www.json.org/json-zh.html)中了解到。

JSON 的全称是 JavaScript Object Notation，它脱胎于常常用于网址开发的编程语言 JavaScript（这个语言我们在模块 5 中也会见到），并根据其他不同编程语言（如 C、Java、Python、JavaScript）的特点，提炼出了它们的数据表达的精髓，才有了这么一种便于数据交换的格式。现如今，大多数的编程语言都支持解析 JSON，并转换成自己语言可用的数据格式。

所以，使用 JSON 是为了“统一规范”。

## 基本数据类型

数据类型是一种声明不同类型变量或函数的系统。数据本身也是有着很多类型的，在模块 1 中，我们已经学习过命令参数类型的概念，了解了整数、浮点数、布尔值、字符串这些概念。其实，这些就是非常基本的数据类型了。

- **数字**（`number`）：在模块 1，我们曾学过整数`int`和浮点数`float`，显然这两种数都是数字。举例：`3`、`-1`、`1.5`、`0.0`都是数字。当然，虽然 JSON 中并不区分整数和浮点数，但是在实际运用中常常还是要注意区分。
- **布尔值**（`boolean`）：也就是`true`和`false`。
- **字符串**（`string`）：用双引号`"`包裹起来的任意文本。在模块 1 我们看到字符串的一些转义方法，例如`\n`、`\\`、`\"`等。通常这些转义方法在附加包领域也已经够用了。

## 键值对

键值对是一种描述属性的方法。例如我们说小明是 15 岁，可以用一个变量赋值`age=15`，代表他是 15 岁。在 JSON 中，我们用**一个键（Key）和一个值（Value）所组成的配对，也就是键值对**来表示这样的属性关系。键的数据类型是一个字符串，而值的数据类型可以是数字、布尔值、字符串，也可以是下面的对象或数组，值的选择范围是很灵活的。

例如，下面的几种都是合适的键值对。

- `"name":"Steve"`：键是`"name"`，值是一个字符串`"Steve"`。
- `"age":15`：键是`"age"`，值是一个数字`15`。
- `"isAlive":true`：键是`"isAlive"`，值是一个布尔值`true`。

## 对象`object`

**对象（Object）是一种键值对的集合**，换言之，里面的内容应该是一个个的键值对。**这些键值对的外围，用一个花括号`{}`包裹，并且键值对与键值对之间，需要用逗号分隔**。例如：

```json
{"name":"Steve","age":15,"isAlive":true}
```

这就是一个有效的 JSON 了，它是一个对象。这个对象由三个键值对`"name":"Steve"`、`"age":15`、`"isAlive":true`组成，并且这三个键值对中间以逗号分隔。

对象本身也是一种基本数据类型，所以对象也可以成为键值对的值，比如：

```json
{"playerInfo":{"name":"Steve"}}
```

这同样也是一个有效的 JSON，它是一个对象。这个对象由一个键值对`"playerInfo":{"name":"Steve"}`组成，其中这个键值对的值就是一个对象`{"name":"Steve"}`，由键值对`"name":"Steve"`组成。

## 换行和空格

在专门的 JSON 文件中，是**允许在 JSON 中出现任意的换行和空格的**，这时同样是能够解析的。例如还是这个例子：

```json
{"name":"Steve","age":15,"isAlive":true}
```

在`{`、`:`和`,`的后面添加一个空格，然后在`}`的前面添加一个空格，也是正确的：

```json
{ "name": "Steve", "age": 15, "isAlive": true }
```

可以看到，虽然只是简单加了几个空格，但是却使得观感变得更自然了一些。毕竟 JSON 设计的初衷，还希望兼顾人们的阅读体验哦。

当然，对于这种简单结构的 JSON 对象，如果可以换行，并且换行的观感要更好的话，我们也会选择插入换行。也就是这样的效果：

```json showLineNumbers
{
    "name": "Steve",
    "age": 15,
    "isAlive": true
}
```

对于这里的 JSON，我们在每个键值对前面插入了 1 个换行和 4 空格的缩进（在前面加上空格可以清晰地展现出层级关系，叫做缩进），这也是目前十分常用的缩进配置。当然，2 空格的缩进也是很常见的。

而对于下面的 JSON：

```json
{"playerInfo":{"Steve":{"age":15,"isAlive":true},"Alex":{"age":17,"isAlive":false}}}
```

我们也可以用类似的方法，在`:`后面插入一个空格，插入换行和 4 空格的缩进：

```json showLineNumbers
{
    "playerInfo": {
        "Steve": {
            "age": 15,
            "isAlive": true
        },
        "Alex": {
            "age": 17,
            "isAlive": false
        }
    }
}
```

看，相比于改写前，这个层级关系是不是一目了然？

但是，虽然说是 JSON 内可以任意加换行和空格，请不要在字符串内、数字内部等展现关键数据的地方添加空格或空行，比如`"Steve"`加空格变成`"Steve "`，以及`15`加空格变成`1 5`这种，那这就完全不是同一个东西了。

## 数组`array`

**数组（Array）和对象是类似的，只不过它是值的集合**。这些值的外围，用一个方括号`[]`包裹，并且值与值之间，需要用逗号分隔。例如：

```json
[ "Beijing", "Shanghai", "Guangzhou", "Shenzhen" ]
```

这里，就是由 4 个值：`"Beijing"`、`"Shanghai"`、`"Guangzhou"`、`"Shenzhen"`所组成的，这 4 个值都是字符串。

同样的，这里的值不仅可以为数字、布尔值、字符串，也可以为对象或者数组。例如：

```json
[
    "firstElement",
    2,
    true,
    {
        "example1": "1-1",
        "example2": "1-2",
        "example3": "1-3"
    },
    [
        "2-1",
        "2-2",
        "2-3"
    ]
]
```

在这个数组里，一共有 5 个值：

- 字符串`"firstElement"`；
- 数字`2`；
- 布尔值`true`；
- 对象`{ "example1": "1-1", "example2": "1-2", "example3": "1-3" }`，它拥有 3 个键值对作为元素：
  - `"example1": "1-1"`；
  - `"example2": "1-2"`；
  - `"example3": "1-3"`。
- 数组`[ "2-1", "2-2", "2-3" ]`，它拥有 3 个值作为元素：
  - 字符串`"2-1"`；
  - 字符串`"2-2"`；
  - 字符串`"2-3"`。

## 常见错误

### 意外的或遗漏的逗号

### 意外的或遗漏的括号

### 语法错误

### 中文符号

### JSON 的注释

## 在命令中出现过的 JSON 的解析

---

## 总结
